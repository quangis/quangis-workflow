@prefix : <https://github.com/quangis/transformation-algebra#>.
@prefix from: <https://github.com/quangis/transformation-algebra#from>.
@prefix type: <https://github.com/quangis/cct#type>.
@prefix via: <https://github.com/quangis/cct#operator>.

_:SolarRadiation
    type: "R(Loc, Ratio)".
_:TerrainDSM
    type: "R(Loc, Itv)".
_:Buildings
    type: "R(Obj, Reg * Nom)".

[] a :Task;
    :question "What is the potential of solar power for each rooftop in the Glover Park neighbourhood in Washington DC?";
    :implementation <https://example.com/#SolarPowerPotentialGloverPark>;
    :input _:SolarRadiation, _:TerrainDSM, _:Buildings;
    :output [
        # Add regions (technical)
        type: "R(Obj, Reg * Ratio)"; # A
        from: [
            # Sum the amount of energy per rooftop
            type: "R(Obj, Ratio)"; # B
            from: [
                # Average potential by aggregating each building rooftop
                type: "R(Obj, Ratio)"; # C average radiation
                from: [
                    # Constrain the solar potential field by the terrain field
                    type: "R(Loc, Ratio)"; # D
                    from: _:TerrainDSM; # E
                    from: _:SolarRadiation # F
                ];
                from: _:Buildings # G
            ];
            from: [
                # Size of the usable building area (rooftops)
                type: "R(Obj, Ratio)"; # H
                from: _:Buildings # G
            ]
        ]
    ].
